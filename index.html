<!DOCTYPE html>
<html>
<head>
  <title>#edpain - Digital Harbor Foundation</title>
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/3.5.1/build/cssreset/cssreset-min.css">
  <!--script src="http://code.jquery.com/jquery-1.7.2.min.js"></script-->
  <script src="jquery.min.js"></script>
  <script src="underscore-min.js"></script>
  <script src="waypoints.min.js"></script>
  <script src="jquery.fittext.js"></script>
  <script src="https://maps.googleapis.com/maps/api/js?sensor=false"></script>
  <script>
  $(function() {
    //force chrome to reset (some problems below when inserting content)
    var forceReset = function() {
      var body = $("body");
      if (body.css("-webkit-transform") == "translateZ(1px)") {
        body.css("-webkit-transform","none");
      }
      else {
        body.css("-webkit-transform",'translateZ(1px)');
      }
    };
    //reflexive layout based on em's
    var win = $(window);
    var fontResizer = function($el, scale) {
      var resize = function() {
        $el.css('font-size', win.width()/scale);
      };
      resize();
      win.on('resize',resize);
    }
    $("#subHeader h1").fitText(0.6);
    $("#subHeader p").fitText(2.5);
    fontResizer($("#description"), 35.0);
    fontResizer($("#painEntry"), 37.0);
    fontResizer($("#pains"), 22.0);
    fontResizer($("#postPainEntry"), 40.0);
    fontResizer($("body > header"), 60.0);
    
    //anal a/an solution
    $("#painEntry .role").keyup(function() {
      var val = $(this).val();
      if (val && (val.length > 0) && ($.inArray(val.substr(0,1).toLowerCase(), ["a","e", "i", "o", "u"]) >= 0)) {
        $("#painEntry .pluralRole").css("visibility", "visible");
      }
      else {
        $("#painEntry .pluralRole").css("visibility", "hidden");
      }
    });
    
    var showPostButton = function() {
      var role = $("#painEntry .role").val();
      var pain = $("#painEntry textarea").val();
      var post = $("#painEntry .post");
      if (role && pain && role.length > 0 && pain.length >= 3) {
        if (post.css("visibility") == "hidden") {
          post.hide()
            .css("visibility", "visible")
            .fadeIn();
        }
      }
      else {
        post.css("visibility", "hidden");
      }
    };
    $("#painEntry .role").keyup(showPostButton).blur(showPostButton);
    $("#painEntry textarea").keyup(showPostButton).blur(showPostButton);
    
    var geocoder = new google.maps.Geocoder();
    $.zipToCityState = function(zip, target) {
      var t = $("#" + target);
      geocoder.geocode({ 'address': zip}, function(results, status) {
        console.log(results);
        if (results) {
          for (var i = 0; i < results.length;i++) {
            if (results[i].types[0] == "postal_code") {
              var a = results[i].formatted_address;
              //strip off zip and country if USA
              if (a.indexOf(zip + ", USA") >= 0) {
                a = a.substr(0,a.indexOf(zip)-1);
              }
              t.replaceWith(a);
              return;
            }
          }
        }
        t.replaceWith(zip);
      });
    };
    
    var painDisplayTemplate = _.template($("#painDisplayTemplate").text());
    var painExtraTemplate = _.template($("#painExtraTemplate").text());
    var pain = $("#painEntry");
    var share = $("#postPainEntry");
    var togglePainOpen = function(el) {
      var extra = el.data("extra");
      if (el.hasClass("open")) {
        if (extra) {
          extra.remove();
        }
      }
      else {
        var tmpl = $(painExtraTemplate());
        el.append(tmpl).data("extra", tmpl);
        tmpl.hide().fadeIn("slow");
        forceReset();
      }
      el.toggleClass("open");
    }
    var extractPain = function() {
      var name = pain.find(".name").val();
      var data = {
        role: pain.find(".role").val(),
        'pain': pain.find("textarea").val(),
        name: name ? name : "",
        zip: pain.find(".zip").val() 
      }
      var newPain = $(painDisplayTemplate(data))
          .prependTo($("#pains ul"))
          .hide()
          .fadeIn('slow');
      $.zipToCityState(data.zip, "zipTarget");
      togglePainOpen(newPain);
      pain.fadeOut('slow', function() { 
        share.fadeIn('slow');
      });
    };
    var goUp = function() {
      pain.find("textarea").val("");
      showPostButton();
      window.scrollTo(0,$("#pains")[0].offsetTop);
      pain.fadeIn('slow');
    };
    var anotherPain = function() {
      if (share.is(":visible")) {
        share.fadeOut('slow', function() {
          goUp();
        });
      }
      else {
        goUp();
      }
    };
    $("#painEntry .post").click(extractPain);
    $("#postPainEntry .back").click(anotherPain);
    $("#pains").on("click", "li", function() {
      togglePainOpen($(this));
    });
    
    // add sticky class (for fixed) when have another 
    // edpain button goes out of the window
    $("#postPainEntry .back").waypoint(function(e,dir) {
      $(this).toggleClass("sticky", dir === "down");
    });
    
    var getTwitterShareUrl = function(text, permalink) {
      var url = "https://twitter.com/intent/tweet";
      url += "?url=" + encodeURI(permalink);
      // add #edpain to front and quote it (or end ellipses)
      url += "&text=" + "%23edpain%20%E2%80%9C" + (text.length <= 109 ? (text + '%E2%80%9D') : (text.substr(0,109) + "%E2%80%A6"));
      return url;
    };
    $("#pains").on("click", "button.twitter", function(e) {
      var li = $(this).closest("li");
      var text = li.find("q").text();
      var permalink = li.find("a").attr("href");
      var url = getTwitterShareUrl(text, permalink);
    	var newwindow = window.open(url);
    	if (window.focus) { 
    	  newwindow.focus();
    	}
      e.stopPropagation();
    });
    var getFacebookShareUrl = function(text, permalink) {
      var url = "http://www.facebook.com/dialog/feed";
      url += "?link=" + encodeURI(permalink);
      url += "&app_id=366391053434145"
      url += "&name=%23edpain";
      url += "&picture=" + encodeURI("http://www.digitalharborfoundation.org/dhf_logo.png");
      url += "&redirect_uri=" +  encodeURI("https://edpain.digitalharborfoundation.org");
      url += "&description=" + (text.length <= 109 ? (text + '%E2%80%9D') : (text.substr(0,109) + "%E2%80%A6"));
      return url;
    };
    $("#pains").on("click", "button.facebook", function(e) {
      var li = $(this).closest("li");
      var text = li.find("q").text();
      var permalink = li.find("a").attr("href");
      var url = getFacebookShareUrl(text, permalink);
    	var newwindow = window.open(url);
    	if (window.focus) { 
    	  newwindow.focus();
    	}
      e.stopPropagation();
    });
  });
  </script>
  <style>
  @font-face {
    font-family: "GeosansLight";
    src: url("GeosansLight.ttf");
  }
  body {
    font-family: "GeosansLight";
    color: #3A3A3A;
    text-align: center;
  }
  body > header {
    width: 100%;
    height: 4em;
    background-color: #F3F1F2;
    font-size: 14pt;
    line-height: 4em;
    text-align:left;
  }
  body > header #preLogo {
    color: #00C12A;
    margin-left: 4em;
    margin-right: .5em;
    display: inline-block;
    vertical-align: text-bottom;
    margin-top: -1em;
  }
  body > header .smallLogo {
    height: 2em;
    margin-top:1em;
  }
  body > header #postLogo {
    color: #00C12A;
    margin-left: .5em;
    display:inline-block;
    vertical-align: text-top;
    margin-top: -1.25em;
  }
  body > header #anchorLogo {
    height: 2.5em;
    padding-right: 4em;
    padding-bottom: 1.5em;
    position:absolute;
    right: 0;
    top: 0; 
    vertical-align: top;
  }
  #anchorLogo {
    word-wrap: nowrap;
    font-size: inherit;
    background-image: url('EdTechLinkAnchor.svg');
    background-position: right top;
    background-size: auto 100%;
    background-repeat: no-repeat;
    color: #3C708A;
  }
  #subHeader {
    text-align: center;
  }
  #subHeader h1 {
    font-size: 200pt;
    font-family: "helvetica";
    font-weight: 800;
    color: transparent;
    text-shadow: .01em .01em .01em #27a9e0, .005em .005em .005em #176586, .01em .01em 0 #27a9e0;
  }
  #subHeader p {
    text-align: middle;
    font-size: 23pt;
    margin-top: -1.1em;
    color: #27a9e0;
    margin-left: 17em;
  }
  #subHeader p strong {
    color: #FEBD25;
  }
  #description {
    font-size: 24pt;
    margin-top: 1.75em;
    text-align: center;
  }
  #description p {
    width: 25em;
    margin-top: 1em;
    margin-left: auto;
    margin-right: auto;
    text-align: left;
    line-height: 1.25em;
  }
  #painEntry {
    font-size: 24pt;
    width: 27em;
    text-align: left;
    display: inline-block;
    margin-left: auto;
    margin-right: auto;
    margin-top: 2em;
  }
  #painEntry input::-ms-input-placeholder ,
  #postPainEntry input::-ms-input-placeholder{
    color: #AAA;
    text-align: center;
  }
  #painEntry input:-moz-placeholder,
  #postPainEntry input:-moz-placeholder {
    color: #AAA;
    text-align: center;
  }
  #painEntry input::-webkit-input-placeholder,
  #postPainEntry input::-webkit-input-placeholder {
    color: #AAA;
    text-align: center;
  }
  #painEntry input,
  #postPainEntry input {
    margin-left:.5em;
    margin-right:.5em;
    background-color: #DDD;
    border: none;
    padding-left: .25em;
    padding-right: .25em;
    border-radius: 3px;
    padding-top: .25em;
    padding-bottom: .25em;
  }
  #painEntry .role {
    width: 13em;
  }
  #painEntry .pluralRole {
    visibility:hidden;
  }
  #painEntry a {
    color: #27a9e0;
    text-decoration: none;
  }
  #painEntry p {
    margin-bottom: .5em;
  }
  #painEntry textarea {
    width: 25.5em;
    background-color: #DDD;
    border: none;
    height: 4em;
    margin-bottom: -.25em;
    padding-left: .25em;
    padding-right: .25em;
    padding-top: .15em;
    padding-bottom: .15em;
    border-radius: 3px;
  }
  #painEntry .name {
    width: 12em;
  }
  #painEntry .zip {
    width: 4.5em;
  }
  #painEntry .identifiers > *:last-child {
    margin-right: 0;
  }
  #painEntry .post,
  #postPainEntry button,
  #pains li button {
    color: white;
    background-color: #00C12A;
    font-family: "GeosansLight";
    border: 0;
    padding:0;
    margin:0;
    font-size:inherit;
    padding-top: .20em;
    padding-bottom: .20em;
    margin-bottom: 1em;
    border-radius:3px;
    box-shadow: 2px 2px 2px #AAA;
    cursor: pointer;
    width: 10.5em;
  }
  #pains li button {
    font-size: 65%;
    background-color: #0091D4;
    opacity: 0.8;
  }
  #pains li button:hover {
    opacity: 1.0;
  }
  #pains li button.twitter {
    clear:both;
    margin-left:4em;
  }
  #pains li a {
    font-size: 35%;
    display: block;
    margin-top: -1.25em;
    float:right;
    margin-right: 5em;
    text-decoration: none;
  }
  #pains li a:hover {
    text-decoration: underline;
  }
  #postPainEntry button.sticky {
    position: fixed;
    top:-.6em;
    left: 50%;
    z-index: 3;
    margin-left: -5.25em;
  }
  #painEntry .post {
    width: 100%;
    visibility: hidden;
  }
  #painEntry .post:hover {
    background-color: #27a9e0;
  }
  #painEntry .post:active,
  #postPainEntry button:active,
  #pains button:active {
    color: #DDD;
    box-shadow: 2px 2px 2px #AAA inset;
    position:relative;
    left:2px;
    top:2px;
  }
  #postPainEntry {
    text-align: center;
    margin-left: auto;
    margin-right: auto;
    display: none;
    width: 26em;
    height: 8em;
  }
  #postPainEntry p {
    margin-top: 1.5em;
    font-size: 180%;
  }
  #postPainEntry q:before {
    content: "#edpain ";
  }
  #postPainEntry q:after {
    content: "";
  }
  #postPainEntry button {
    padding-left: .5em;
    padding-right: .5em;
    padding-top: .25em;
    padding-bottom: .25em;
    background-color: #FEBD25;
    opacity: 0.8;
    cursor: pointer;
    margin-top: .5em;
  }
  #postPainEntry button:hover {
    opacity: 1.0;
  }
  #postPainEntry button.twitter,
  #postPainEntry button.facebook {
    width: 12.6em;
    background-color: #27a9e0;
  }
  #postPainEntry button.twitter {
    margin-right: .25em;
  }
  #postPainEntry p {
    text-align: center;
    margin-bottom:.25em;
  }
  #postPainEntry .email {
    width: 16.8em;
    margin-left: 0;
    margin-right: .25em;
    margin-top: 1em;
  }
  #postPainEntry .connect {
    width: 8em;
    margin-left: 0;
    background-color: #00C12A;
  }
  #pains {
    text-align:left;
    font-size: 48pt;
    overflow: visible;
    margin-top: 1em;
    width: 21em;
    margin-left: .5em;
  }
  #pains h2 {
    color: #27a9e0;
    font-size: inherit;
    margin-left: 1em;
    margin-bottom: .5em;
    display:none;
  }
  #pains q {
    display: block;
    color: black;
    font-size: inherit;
    margin-left: 2.5em;
  }
  #pains cite {
    display:block;
    font-size: 50%;
    margin-left: 5em;
  }
  #pains q:before {
    content: "\201C";
    display:inline-block;
    margin-right: .15em;
    font-size: 375%;
    float: left;
    position:absolute;
    left:.25em;
    top:-.137em;
    font-weight: 800;/*
    margin-top: -.137em;
    margin-left: .25em;*/
  }
  #pains li {
    clear: both;
    margin-bottom: 1.5em;
    margin-right: 2.75em;
    position: relative;
  }
  #pains li:after {
    content: "\3009";
    display: block;
    position: absolute;
    right: -1.25em;
    top: 0;
    font-size: 200%;
    opacity: .3;
    font-weight: 800;
    overflow: visible;
    transition: all .25s ease-in-out;
    -webkit-transition: all .25s ease-in-out;
    -moz-transition: all .25s ease-in-out;
    -o-transition: all .25s ease-in-out;
    -ms-transition: all .25s ease-in-out;
  }
  #pains li:hover:after {
    opacity: 1.0;
  }
  #pains li.open:after {
    opacity: 1.0;
    transform: rotate(90deg);
    transform-origin: 40% 50% 0;
    -webkit-transform: rotate(90deg);
    -webkit-transform-origin: 40% 50% 0;
    -moz-transform: rotate(90deg);
    -moz-transform-origin: 40% 50% 0;
    -ms-transform: rotate(90deg);
    -ms-transform-origin: 40% 50% 0;
  }
  #pains q:after {
    content: "\201D";
    color: black;
  }
  #pains li:nth-child(3n+0) q:before,
  #pains li:nth-child(3n+0) cite,
  #pains li:nth-child(3n+0):after, 
  #pains li:nth-child(3n+0) a {
    color: #FEBD25;
  }
  #pains li:nth-child(3n+0) button {
    background-color: #FEBD25;
  }
  #pains li:nth-child(3n+1) q:before,
  #pains li:nth-child(3n+1) cite,
  #pains li:nth-child(3n+1):after, 
  #pains li:nth-child(3n+1) a {
    color: #0091D4;
  }
  #pains li:nth-child(3n+1) button {
    background-color: #0091D4;
  }
  #pains li:nth-child(3n+2) q:before,
  #pains li:nth-child(3n+2) cite,
  #pains li:nth-child(3n+2):after, 
  #pains li:nth-child(3n+2) a {
    color: #00C12A;
  }
  #pains li:nth-child(3n+2) button {
    background-color: #00C12A;
  }
  </style>
  <script type="template/jquery" id="painDisplayTemplate">
  <li>
    <q><%=pain %></q>
    <cite><%=name %> &mdash; <%=role%> from <span id="zipTarget"><%= zip %></span></cite>
  </li>
  </script>
  <script type="template/jquery" id="painExtraTemplate">
  <div class="painExtra">
    <a href="http://edpain.digitalharborfoundation.org/pains/1234">permalink</a>
    <button class="twitter">tweet it</button>
    <button class="facebook">facebook it</button>
  </div>
  </script>
</head>
<body>
  <header>
    <span id="preLogo">&nbsp;</span>
    <a href="http://www.digitalharborfoundation.org"><img src="smallDHFLogo.svg" alt="Digital Harbor Foundation" class="smallLogo"></a>
    <span id="postLogo">project</span>
    <div id="anchorLogo">
      We link learners to doers
    </div>
  </header>
  <section id="subHeader">
    <h1>#edpain</h1>
    <p>identifying the <strong>pain points</strong> of education</p>
  </section>
  <section id="description">
    <p>This wall is an open platform for teachers, administrators, policy makers, and technologists to constructively identify pain points in education that need solving. Let's share what stands between us and great education.</p>
  </section>
  <section id="painEntry">
    <p>I'm a<span class="pluralRole">n</span> <input type="text" class="role" placeholder="teacher, student, parent, etc."/> and I have an <a href="https://twitter.com/#!/search/%23edpain" target="_blank">#edpain</a>:</p>
    <p class="description"><textarea maxlength="300"></textarea></p>
    <p class="identifiers">My name is <input type="text" class="name"/> from <input type="text" placeholder="zip code" class="zip"></p>
    <p>and I agree to share this <a href="https://twitter.com/#!/search/%23edpain" target="_blank">#edpain</a> under the <a href="http://creativecommons.org/publicdomain/zero/1.0/" target="_blank">CC0 license</a>.</p>
    <button class="post">post your edpain</button>
  </section>
  <section id="postPainEntry">
    <p>Thank you for sharing your #edpain.</p>
    <input type="text" class="email" placeholder="email"></input>
    <button class="connect">stay connected</button>
    <button class="back">Have another edpain?</button>
  </section>
  <section id="pains">
    <h2>edpains</h2>
    <ul>
      <li>
        <q>There is not enough technology in my school</q>
        <cite>John Smith - student from Baltimore, MD</cite>
      </li>
      <li>
        <q>Too many sites are blocked in my school. I hate how they don't trust us.</q>
        <cite>Jane Doe - student from Washington, DC</cite>
      </li>
      <li>
        <q>I buy technology for my teachers and they don't seem to use it.</q>
        <cite>Lisa Smith - principal from New York City, NY</cite>
      </li>
    </ul>
  </section>
</body>
</html>